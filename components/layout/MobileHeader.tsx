'use client'

import { usePathname } from 'next/navigation'
import { HelpCircle } from 'lucide-react'
import { useSidebar } from './SidebarContext'
import { useTour } from '@/components/providers/TourContext'

export default function MobileHeader({ title }: { title?: string }) {
  const { isExpanded } = useSidebar()
  const pathname = usePathname()
  const { startPageTour } = useTour()

  const handleHelpClick = () => {
    // Determine current page from pathname
    const pageName = pathname?.split('/')[1] || 'dashboard'
    startPageTour(pageName)
  }

  return (
    <header 
      className={`sticky top-0 left-0 right-0 bg-white/80 backdrop-blur-lg border-b border-pink-primary/10 z-40 transition-[left] duration-300 ease-out ${
        isExpanded ? 'md:left-[240px]' : 'md:left-[69px]'
      }`}
    >
      <div className="relative flex items-center justify-center h-14 px-4">
        <svg width="148" height="24" viewBox="0 0 148 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M81.5509 9.03731L81.7068 9.73026C82.9194 6.94562 87.628 6.30492 89.2 9.10422L89.6656 10.3059C90.9168 6.92087 96.2991 5.8072 98.003 9.42778C98.8243 11.1712 98.6181 15.9897 98.6401 18.1181C98.6529 19.3592 98.6291 20.6186 98.6391 21.8431L92.9901 21.8991L92.827 13.5204C92.5117 11.6111 90.4658 12.1318 90.1862 13.7743L90.2357 21.9779L84.6326 22.0017C84.4694 21.8761 84.6179 20.6415 84.6133 20.3399C84.5867 18.3261 84.7114 15.602 84.4712 13.6661C84.2018 11.4929 81.9707 12.2491 81.8232 14.0016L81.9772 22.032L76.1962 22.0906L76 7.86589L81.6014 7.71007L81.5509 9.03822V9.03731Z" fill="#CB1F70"/>
          <path d="M5.85342 2.87793L6.41713 10.1062C6.71961 9.74878 6.90751 9.29781 7.23657 8.95591C10.2604 5.82297 15.2257 7.29137 15.8462 11.812C16.2733 14.9212 16.3696 18.4492 16.5877 21.6123C16.596 21.7352 16.6391 21.8213 16.6821 21.9295L10.6326 22.3887L10.0817 14.6443C10.133 12.2282 7.22465 11.9275 6.87634 14.2768L7.60413 22.6591L1.66088 23.111L0 3.3234L5.85342 2.87793Z" fill="#CB1F70"/>
          <path d="M39.9653 7.81529C41.4062 6.01509 43.5968 5.41746 45.8104 6.04809C48.1973 6.7282 49.1588 8.91888 49.134 11.2571L48.0314 21.1986L42.0725 20.557L43.089 12.3543C43.0588 10.5211 40.561 10.2626 39.9387 11.9602C39.8177 12.2883 39.7572 12.7457 39.7022 13.0986C39.3759 15.1912 39.2081 17.4717 38.9579 19.5955C38.935 19.7916 38.968 19.9951 38.9579 20.1912L33 19.5487L34.5582 5.06641L40.0615 5.75019L40.144 5.92893L39.9662 7.81621L39.9653 7.81529Z" fill="#CB1F70"/>
          <path d="M56.2793 8.10799C56.9393 7.1483 57.7404 6.22987 58.8477 5.77249C62.1511 4.40767 65.3729 6.25737 65.7093 9.8147L66.4435 19.7397L60.4948 20.2071C60.3775 18.1118 60.2097 16.0183 60.0383 13.9266C59.9613 12.9926 60.1511 11.0237 58.8706 10.7872C57.7477 10.5801 56.9017 11.3647 56.8302 12.4618L57.3783 20.4803L51.4213 20.9404L50.4131 6.45719L56.2803 5.9998V8.10799H56.2793Z" fill="#CB1F70"/>
          <path d="M147.412 20.9408L141.594 21.6933L140.495 13.1937C140.489 13.1451 140.252 12.7033 140.197 12.6254C139.598 11.7895 138.23 12.0122 137.793 12.9105C137.752 12.9957 137.581 13.5292 137.586 13.5695L138.685 22.0691C137.373 22.268 136.04 22.3744 134.726 22.5769C134.392 22.6283 133.021 23.0591 132.816 22.8336L130.827 8.48144L136.44 7.57125L136.711 9.66202C137.105 8.93424 137.426 8.35403 138.066 7.80224C141.069 5.21834 145.352 6.6849 145.985 10.6355L147.411 20.9399L147.412 20.9408Z" fill="#CB1F70"/>
          <path d="M23.2814 5.06537V13.5439C23.2814 13.7318 23.4877 14.4092 23.6068 14.5934C23.7636 14.8363 24.0679 15.0719 24.3575 15.126C24.792 15.2066 25.1614 15.1462 25.4584 14.9821C26.1495 14.5999 26.3099 13.455 26.3099 13.455L26.3979 5.06445H32.035L31.9891 19.9134H26.4895V18.0802C25.1357 19.7447 23.2778 20.3433 21.1512 20.0729C19.263 19.8327 17.5068 18.0637 17.5068 16.1095V5.06537H23.2814Z" fill="#CB1F70"/>
          <path d="M106.488 4.04926C116.708 3.00984 117.446 18.7552 107.651 19.5114C97.6563 20.2832 96.7699 5.03736 106.488 4.04926ZM106.666 8.90175C103.963 9.40405 105.397 15.9018 108.222 14.3079C109.995 13.3079 109.181 8.43428 106.666 8.90175Z" fill="#CB1F70"/>
          <path d="M122.939 6.11958C128.83 6.05817 132.205 12.434 129.604 17.5588C126.54 23.5946 117.595 22.7092 115.689 16.2499C114.223 11.2782 117.652 6.17458 122.939 6.11958ZM123.839 16.1481C124.945 15.094 125.794 11.5211 123.694 11.0885C121.678 10.6733 120.639 13.753 120.855 15.3012C121.055 16.7329 122.813 17.1252 123.84 16.1472L123.839 16.1481Z" fill="#CB1F70"/>
          <path d="M74.0627 8.18154L72.9618 22.1139L67.0039 21.6565L68.0222 7.64258L74.0627 8.18154Z" fill="#CB1F70"/>
          <path d="M70.6477 0.0476685C73.1308 -0.289641 75.2426 1.18334 74.9768 3.82682C74.5726 7.84886 67.0885 7.61788 67.7604 2.65998C67.952 1.24658 69.2847 0.232822 70.6477 0.0476685Z" fill="#CB1F70"/>
        </svg>

        {/* Help Icon - Absolutely positioned on the right */}
        <button
          onClick={handleHelpClick}
          className="absolute right-4 p-2 text-pink-primary/70 hover:text-pink-primary hover:bg-pink-light rounded-full transition-colors"
          aria-label="Page Help"
        >
          <HelpCircle size={18} strokeWidth={2} />
        </button>
      </div>
    </header>
  )
}
